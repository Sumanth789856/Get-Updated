<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ title or "Student Portal" }}</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>
  <body>
    <!-- Sidebar -->
    <div class="sidebar">
      <h2>GET UPDATED</h2>
      <a href="{{ url_for('index') }}">ğŸ  Home</a>
      <a href="{{ url_for('dashboard') }}">ğŸ“Š Dashboard</a>
      <a href="{{ url_for('notes') }}">ğŸ“š Notes</a>
      <a href="{{ url_for('announcements') }}">ğŸ“¢ Announcements</a>
      {% if 'username' in session %}
      <a href="{{ url_for('logout') }}">ğŸšª Logout</a>
      {% else %}
      <a href="{{ url_for('login') }}">ğŸ”‘ Login</a>
      {% endif %}
    </div>

    <!-- Main -->
    <div class="main">
      <div class="topbar">
       
      </div>

   
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/view_users.css') }}"
/>

<h2>View Users</h2>

<!-- Search Bar -->
<input
  type="text"
  id="searchInput"
  placeholder="Search users..."
  class="search-box"
/>

<table class="user-table" id="userTable">
  <thead>
    <tr>
      <th onclick="sortTable(0)">ID â¬</th>
      <th onclick="sortTable(1)">Username â¬</th>
      <th onclick="sortTable(2)">Email â¬</th>
      <th onclick="sortTable(3)">Role â¬</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for user in users %}
    <tr>
      <td>{{ user[0] }}</td>
      <td>{{ user[1] }}</td>
      <td>{{ user[2] }}</td>
      <td>{{ user[3] }}</td>
      <td>
        <form
          method="POST"
          action="{{ url_for('delete_user', user_id=user[0]) }}"
          style="display: inline"
        >
          <button type="submit" class="delete-btn">Delete</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<script>
  // ğŸ” Search Filter
  document.getElementById("searchInput").addEventListener("keyup", function () {
    let filter = this.value.toLowerCase();
    let rows = document.querySelectorAll("#userTable tbody tr");

    rows.forEach((row) => {
      let text = row.textContent.toLowerCase();
      row.style.display = text.includes(filter) ? "" : "none";
    });
  });

  // â¬ Sort Function
  function sortTable(columnIndex) {
    let table = document.getElementById("userTable");
    let rows = Array.from(table.rows).slice(1); // skip header
    let asc = table.getAttribute("data-sort-dir") !== "asc";

    rows.sort((a, b) => {
      let aText = a.cells[columnIndex].innerText.toLowerCase();
      let bText = b.cells[columnIndex].innerText.toLowerCase();
      return asc ? aText.localeCompare(bText) : bText.localeCompare(aText);
    });

    rows.forEach((row) => table.tBodies[0].appendChild(row));
    table.setAttribute("data-sort-dir", asc ? "asc" : "desc");
  }
</script>
</body
</html>
